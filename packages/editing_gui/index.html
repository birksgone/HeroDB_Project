<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HeroDB Curation Tool</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div x-data="curationTool">

        <!-- <header>
            <h1>HeroDB Curation Tool</h1>
            <div class="controls">
                <fieldset>
                    <legend>API Target</legend>
                    <label><input type="radio" name="api_target_radio" x-model="apiTarget" value="local" checked>
                        Local</label>
                    <label><input type="radio" name="api_target_radio" x-model="apiTarget" value="render">
                        Render</label>
                </fieldset>
                <fieldset>
                    <legend>Credentials</legend>
                    <input type="text" x-model="username" placeholder="API Username">
                    <input type="password" x-model="password" placeholder="API Password">
                </fieldset>
            </div>
        </header> -->

        <main>
            <section class="tool">
                <h2>Search Hero Blocks</h2>
                <div class="form">
                    <input type="text" x-model="heroSearch.key" placeholder="JSON Key (e.g., propertyType)">
                    <input type="text" x-model="heroSearch.keyword" placeholder="Keyword (e.g., ChainStrike)">
                    <button @click="performHeroSearch()">Search Blocks</button>
                    <button @click="clearHeroSearch()" class="secondary">Clear</button>
                </div>
            </section>

            <section class="tool">
                <h2>SuperSearch Language DB</h2>
                <div class="form-grid">
                    <input type="text" x-model="langSearch.ids[0]" placeholder="ID contains...">
                    <input type="text" x-model="langSearch.ids[1]" placeholder="ID contains...">
                    <input type="text" x-model="langSearch.ids[2]" placeholder="ID contains...">
                    <input type="text" x-model="langSearch.ids[3]" placeholder="ID contains...">

                    <input type="text" x-model="langSearch.texts[0]" placeholder="EN/JA text contains...">
                    <input type="text" x-model="langSearch.texts[1]" placeholder="EN/JA text contains...">
                    <input type="text" x-model="langSearch.texts[2]" placeholder="EN/JA text contains...">
                    <input type="text" x-model="langSearch.texts[3]" placeholder="EN/JA text contains...">
                </div>
                <div class="form">
                    <button @click="performLangSearch()">Search Lang DB</button>
                    <button @click="clearLangSearch()" class="secondary">Clear</button>
                </div>
            </section>

            <section class="results">
                <hr>
                <h2>Results</h2>
                <div x-show="loading" class="status">Loading...</div>
                <div x-show="error" class="status error" x-text="error"></div>

                <div x-show="results">
                    <div class="results-header">
                        <p><strong x-text="results ? results.count : 0"></strong> items found.</p>
                        <!-- --- NEW: The "Share with AI" button --- -->
                        <button @click="shareWithAI()" x-show="lastSuccessfulUrl" class="primary">Share with AI</button>
                    </div>
                    <div class="tabs">
                        <button :class="{ 'active': viewMode === 'table' }" @click="viewMode = 'table'">Table
                            View</button>
                        <button :class="{ 'active': viewMode === 'json' }" @click="viewMode = 'json'">Raw JSON</button>
                    </div>

                    <div x-show="viewMode === 'table'">
                        <table>
                            <thead x-html="tableHeaders"></thead>
                            <tbody>
                                <template x-for="row in tableRows" :key="row.key">
                                    <tr>
                                        <template x-for="cell in row.cells">
                                            <td x-html="cell"></td>
                                        </template>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div x-show="viewMode === 'json'">
                        <textarea readonly x-text="JSON.stringify(results, null, 2)"></textarea>
                    </div>
                </div>
            </section>
        </main>

    </div>

    <!-- Scripts are loaded at the very end of the body for maximum reliability -->
    <script src="https://unpkg.com/alpinejs@3.14.1/dist/cdn.min.js" defer></script>
    <script src="app.js"></script>
</body>

</html>